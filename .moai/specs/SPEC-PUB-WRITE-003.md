# SPEC-PUB-WRITE-003: AI 원고 집필 도구 (주제 → 완성원고)

**Version**: 1.0.0
**Status**: DRAFT
**Priority**: HIGH
**Phase**: Phase 1 (핵심 파이프라인)
**Created**: 2025-11-16
**Updated**: 2025-11-16
**Language**: 한국어
**Owner**: @user

---

## 📋 규격 요약

작가가 주제와 기본 아이디어만 제공하면, AI가 출판 기획안을 수립하고 완전한 원고를 집필하여 당장 출판 가능한 완성원고 마크다운을 생성합니다. 이는 신인 작가의 진입장벽을 낮추고, 대량 출판을 가능하게 하는 핵심 도구입니다.

**3단계 프로세스**:
1. 기획안 고도화 (주제 → 상세 계획)
2. 원고 병렬 집필 (챕터별 동시 작성)
3. 팩트체크 및 최종 검수

---

## 🎯 필수 요구사항 (UBIQUITOUS)

> 시스템은 당장 출판이 가능한 완성원고만 생성해야 함 (팩트체크 완료)
> 시스템은 각 단계별 검수 체크포인트를 유지해야 함
> 시스템은 작가의 의도를 최대한 보존해야 함
> 시스템은 집필 과정의 모든 단계를 추적 가능해야 함
> 시스템은 데이터 신뢰성 검증을 필수로 수행해야 함

---

## 📁 이벤트 기반 요구사항 (EVENT-DRIVEN)

### WHEN 신규 작가가 집필 도구에 접근할 때

```
GIVEN: 신규 또는 기존 작가
WHEN: "새 원고 시작" 버튼 클릭
THEN: 시스템은 다음을 수행해야 함
  ✅ 구조화된 요청 양식 제시:
       - 주제/제목
       - 부제/부설명
       - 목표 독자층
       - 핵심 메시지 (3-5줄)
       - 예상 챕터 구조 (아웃라인)
  ✅ 작가 프로필 정보 수집 (분야 전문성, 참고 자료 등)
  ✅ 완성 예상 시간 안내
```

### WHEN 작가가 기본 정보를 제출할 때

```
GIVEN: 작가 입력 (주제 + 아웃라인 + 추가 정보)
WHEN: "기획안 수립" 버튼 클릭
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-writer] 에이전트로 기획안 고도화:
       - 시장성 분석 (타겟 시장, 경쟁 도서, 차별점)
       - 콘텐츠 구조화 (목차 확정, 각 장 핵심 내용)
       - 팩트체크 항목 선정 (검증 필요 사항 목록)
  ✅ 기획안 사용자 확인 및 수정 기회 제공
  ✅ 승인 시 집필 단계로 진행
```

### WHEN 기획안이 확정될 때

```
GIVEN: 최종 확정된 기획안 + 목차
WHEN: 사용자가 "집필 시작" 버튼 클릭
THEN: 시스템은 다음을 수행해야 함
  ✅ 챕터별 세부 계획 자동 분해
  ✅ [moai-pub-writer] 에이전트 병렬 호출 (최대 5개 챕터 동시)
  ✅ 각 에이전트에 다음을 전달:
       - 챕터 목표 및 핵심 내용
       - 앞뒤 챕터 요약 (문맥 유지)
       - 참고 자료 및 출처
       - 팩트체크 항목
  ✅ 집필 진행 상황 실시간 추적
```

### WHEN 챕터별 집필이 완료될 때

```
GIVEN: 집필 완료된 챕터
WHEN: 각 챕터 완성
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-fact-checker] 스킬로 팩트체크 실행:
       - 주요 주장 검증
       - 데이터/통계 신뢰도 확인
       - 출처 표기 검증
  ✅ 발견된 오류 자동 수정 또는 사용자 확인
  ✅ [moai-pub-editor] 에이전트로 교정교열 + 윤문
  ✅ 편집된 버전 저장
```

### WHEN 모든 챕터가 완료될 때

```
GIVEN: 편집 완료된 모든 챕터
WHEN: 마지막 챕터 처리 완료
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-orchestrator]로 통합:
       - 장절 순서 확인 및 연결
       - 목차 자동 생성
       - 상호 참조 정확성 검증
  ✅ 전체 원고 일관성 검수:
       - 용어 통일
       - 톤앤매너 일관성
       - 논리적 연속성
  ✅ 최종 팩트체크 (전체 원고)
  ✅ 완성원고 마크다운 생성
```

---

## 🚫 원하지 않는 동작 (UNWANTED BEHAVIOR)

### IF 기획안의 시장성 부족

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 경고 알림 (시장성 점수 <50점)
  ✅ 구체적인 개선 제안 제시
  ✅ 기획안 수정 기회 제공
  ✅ 진행 여부는 작가 재확인 후 결정
```

### IF 팩트체크에서 신뢰도 낮은 정보 발견

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 해당 부분 플래그 표시
  ✅ 신뢰 출처 제시 또는 문구 수정 제안
  ✅ 작가 확인 필수
  ✅ 미확인 상태로는 출판 진행 불가
```

### IF 챕터별 집필 품질 편차

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 품질 편차 정량화 (각 챕터 점수)
  ✅ 낮은 점수 챕터 재작성 제안
  ✅ 전체 일관성 검수 강화
  ✅ 작가 선택: 재작성 또는 수동 편집
```

### IF 병렬 집필 중 문맥 불일치

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 통합 단계에서 자동 감지
  ✅ 불일치 부분 명확히 지적
  ✅ 자동 수정 시도 또는 수동 확인 요청
  ✅ 논리적 연속성 재검증
```

---

## ⚙️ 상태 기반 요구사항 (STATE-DRIVEN)

### WHILE 병렬 집필 진행 중

```
시스템은 다음을 유지해야 함:
  ✅ 챕터별 진행 상황 (계획/집필중/팩트검증중/편집중/완료)
  ✅ 전체 진행률 계산
  ✅ 예상 완료 시간 업데이트
  ✅ 챕터 간 문맥 연결성 모니터링
  ✅ 팩트체크 대기 항목 추적
```

---

## 🎁 선택 기능 (OPTIONAL)

### WHERE 작가가 집필 스타일을 커스터마이징하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 문체 선택 (학술적/대중적/창의적)
  ✅ 길이 선택 (단편/중편/장편)
  ✅ 톤 선택 (진지함/위트/친근함)
```

### WHERE 작가가 참고 자료를 직접 제공하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 참고 자료 업로드 기능 (PDF, 링크, 텍스트)
  ✅ 자료 자동 요약 및 활용
  ✅ 출처 자동 인용 및 정리
```

---

## ✅ 수용 기준 (ACCEPTANCE CRITERIA)

### Given/When/Then 시나리오 1: 기본 집필 흐름

```
Given: 신인 작가 + 주제 "미래 기술과 인문학"
When: 전체 집필 파이프라인 실행
Then:
  ✅ 기획안: 2시간 내 완성 (시장성 점수 ≥70점)
  ✅ 집필: 2-3주 내 50,000-80,000단어 완성원고 생성
  ✅ 팩트체크: 100% 신뢰도 검증 완료
  ✅ 최종 원고: 당장 출판 가능 (편집 불필요)
  ✅ 품질: 가독성 ≥85점, 일관성 ≥90점
```

### Given/When/Then 시나리오 2: 병렬 집필 최적화

```
Given: 10개 챕터 분량의 원고
When: 5개 에이전트로 병렬 집필 실행
Then:
  ✅ 단계별 병렬도 유지 (최대 5개 동시)
  ✅ 완료 시간: 순차 대비 60% 단축
  ✅ 챕터 간 문맥 일관성: ≥90점
  ✅ 전체 통합 시간: 2-3시간
```

### Given/When/Then 시나리오 3: 팩트체크 완전성

```
Given: 완성된 50개 주요 주장 포함 원고
When: 팩트체크 실행
Then:
  ✅ 50개 주장 100% 검증
  ✅ 신뢰도 낮은 항목 <5% (수정 또는 제거)
  ✅ 모든 출처 명시 및 인용 정확성 검증
  ✅ 최종 원고 출판 승인
```

---

## 📊 기술 스택 및 의존성

**필수 에이전트**:
- `moai-pub-writer`: 기획안 수립 + 원고 집필
- `moai-pub-editor`: 교정교열 + 윤문
- `moai-pub-orchestrator`: 병렬 처리 조율

**필수 스킬**:
- `moai-pub-fact-checker`: 팩트체크 + 신뢰도 검증
- `moai-pub-style-guide`: 스타일 가이드 적용
- `moai-pub-chunking`: 장절 분할

**외부 자료**:
- Context7 MCP (참고 자료 검색)
- 신뢰할 만한 데이터베이스 (팩트체크)

**버전 요구사항**:
- Python ≥3.11
- Claude Sonnet 4.5+ (복잡한 집필)
- Claude Haiku 4.5 (병렬 처리)

---

## 📈 성공 지표

- **기획안**: 2시간 내 완성, 시장성 점수 ≥70점
- **집필 속도**: 50K 단어 2-3주 완성
- **팩트체크**: 100% 검증 완료, <5% 오류
- **품질**: 가독성 ≥85점, 일관성 ≥90점
- **출판 준비**: 추가 편집 없이 출판 가능

---

## 🔄 의존성

- SPEC-PUB-EDIT-004: 편집 로직 재사용
- SPEC-007: 병렬 처리 및 통합 기반 필요
