# SPEC-PUB-EDIT-COMPREHENSIVE-001: 번역된 PDF 문서 포괄적 편집 도구

**Version**: 1.0.0
**Status**: DRAFT
**Priority**: HIGH
**Phase**: Phase 1 (핵심 파이프라인)
**Created**: 2025-11-18
**Updated**: 2025-11-18
**Language**: 한국어
**Owner**: @user

---

## 📋 규격 요약

번역이 완료된 한국어 PDF 문서(LAF, SAF, SOSHR, CS 등)를 입력받아 **교정(맞춤법/표기법)**, **교열(팩트 검증/최신성)**, **윤문(문체/명확성)**의 3가지 편집 프로세스를 거쳐 출판 완성도 높은 원고로 변환하는 자동화된 편집 도구를 구축합니다.

**핵심 처리 단계**:
1. 문서 분석 (구조, 문제점 파악, 도메인 분류)
2. 교정 (한국어 맞춤법, 외국어 표기법, 공식 문서 규칙 준수)
3. 교열 (2025년 기준 팩트 검증, 구식 정보 식별)
4. 윤문 (문체 통일, 문장 개선, 의도 전달 최적화)
5. 최종 통합 및 검수

---

## 🎯 필수 요구사항 (UBIQUITOUS)

> 시스템은 2025년 11월 기준의 최신 한국어 표기 규칙을 준수해야 함
> 시스템은 원문 저자의 의도와 문맥을 완벽히 보존해야 함
> 시스템은 각 편집 단계별 변경 사항을 감사 추적 가능하게 기록해야 함
> 시스템은 출판 완성도 높은 문서를 생성해야 함
> 시스템은 여러 문서의 순차 또는 병렬 처리를 지원해야 함
> 시스템은 2025년 기준의 팩트 검증을 수행해야 함

---

## 📁 이벤트 기반 요구사항 (EVENT-DRIVEN)

### WHEN 사용자가 편집할 문서들을 업로드할 때

```
GIVEN: 번역 완료된 한국어 마크다운 파일 (1개 이상)
       또는 PDF → 마크다운으로 변환된 파일
WHEN: 사용자가 문서 파일과 편집 설정 선택 (문서명, 도메인, 대상 독자)
THEN: 시스템은 다음을 수행해야 함
  ✅ 문서 포맷 자동 감지 및 정규화 (마크다운으로 통일)
  ✅ 문서 메타데이터 수집 (제목, 저자, 페이지 수 등)
  ✅ 문서 구조 분석 (장/절/단락 자동 감지)
  ✅ 기본 통계 제시 (단어 수, 문단 수, 예상 편집 시간)
  ✅ 문서별 도메인 자동 분류 (스타트업, 금융, 법률 등)
```

### WHEN 문서 분석이 완료될 때

```
GIVEN: 업로드된 한국어 문서
WHEN: 자동 분석 완료
THEN: 시스템은 다음을 수행해야 함
  ✅ [format-expert] 에이전트로 문서 진단:
       - 맞춤법 오류 패턴 분석
       - 외국어 표기법 일관성 검사
       - 구조적 문제점 식별
  ✅ [fact-checker] 에이전트로 팩트 검증 준비:
       - 검증 필요 항목 식별 (수치, 통계, 기관명, 년도 등)
       - 2025년 기준 구식 정보 예측
  ✅ 문제점 요약 리포트 제시
  ✅ 사용자 확인 후 편집 시작
```

### WHEN 교정(Proofreading) 단계 시작될 때

```
GIVEN: 분석 완료된 문서
WHEN: 사용자가 "교정 시작" 선택
THEN: 시스템은 다음을 수행해야 함
  ✅ [format-expert] 에이전트로 자동 교정:
       - 한국어 맞춤법 검사 (띄어쓰기, 오타, 중복)
       - 외국어 표기법 일관성 검증
       - 숫자, 단위, 기호 규칙 적용
       - 공식 문서 규칙 적용
  ✅ 부분별 병렬 처리 (최대 5개 청크 동시)
  ✅ 수정 사항 모두 기록 (원문 vs 수정본)
  ✅ 사용자 검토 기회 제공 (수락/거부/재검토)
```

### WHEN 교열(Fact-checking) 단계 시작될 때

```
GIVEN: 교정 완료된 문서
WHEN: 사용자가 "교열 시작" 선택
THEN: 시스템은 다음을 수행해야 함
  ✅ [fact-checker] 에이전트로 팩트 검증:
       - Context7 MCP를 통한 2025년 기준 정보 검색
       - 통계, 수치 검증
       - 기관명, 인물명 검증
       - 역사적 사실 검증
  ✅ 구식 정보 식별 (✏️ 편집자 주석으로 표시):
       - "[2025년 기준: 현재는 ~]"
       - 원문은 유지하되 주석 추가
  ✅ 검증 결과 리포트 제시
  ✅ 사용자 승인 또는 수정
```

### WHEN 윤문(Copywriting) 단계 시작될 때

```
GIVEN: 교열 완료된 문서
WHEN: 사용자가 "윤문 시작" 선택
THEN: 시스템은 다음을 수행해야 함
  ✅ [copywriting-expert] 에이전트로 윤문:
       - 문장 구조 개선 (단문화, 명확성)
       - 문체 통일 (존댓말 유지, 톤앤매너)
       - 가독성 최적화 (리듬감, 흐름)
       - 저자 의도 완벽 보존
  ✅ 문단별 병렬 처리 (최대 10개 단락)
  ✅ 주요 수정 사항 기록
  ✅ 원문과 개선본 비교 제공
```

### WHEN 각 편집 단계가 완료될 때

```
GIVEN: 처리된 청크/단락
WHEN: 각 단계 완성
THEN: 시스템은 다음을 수행해야 함
  ✅ 원문과 편집본 자동 비교 생성
  ✅ 주요 변경 사항 시각적 강조
  ✅ 사용자 검토 옵션 제공
  ✅ 피드백 수집 및 반영
  ✅ 다음 단계로 자동 진행 (또는 대기)
```

### WHEN 모든 편집 단계가 완료될 때

```
GIVEN: 교정/교열/윤문 완료된 모든 부분
WHEN: 최종 편집 완료
THEN: 시스템은 다음을 수행해야 함
  ✅ [orchestrator] 에이전트로 문서 통합 (원본 순서 복원)
  ✅ 전체 문서 최종 일관성 검수:
       - 용어 통일도 검증
       - 톤앤매너 일관성
       - 구조 완결성
  ✅ 최종 마크다운 생성
  ✅ 편집 리포트 생성 (변경 통계, 품질 점수)
  ✅ 사용자 최종 승인 대기
```

### WHEN 사용자가 여러 문서를 순차 처리할 때

```
GIVEN: 편집할 문서 목록 (LAF, SAF, SOSHR, CS 등)
WHEN: 사용자가 배치 처리 선택
THEN: 시스템은 다음을 수행해야 함
  ✅ 문서별 편집 스케줄 자동 생성
  ✅ 문서 순서 최적화 (도메인별 묶음)
  ✅ 공통 용어집 자동 생성 (전체 문서 일관성)
  ✅ 문서별 진행 상황 실시간 추적
  ✅ 각 문서 완료 후 다음 문서 자동 시작
```

---

## 🚫 원하지 않는 동작 (UNWANTED BEHAVIOR)

### IF 편집 과정에서 원문의 저자 의도 훼손 가능성 감지

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 해당 부분 플래그 표시 (⚠️ 주의 필요)
  ✅ 원문과 편집본 명확히 제시
  ✅ 변경 이유 설명 제공
  ✅ 사용자 최종 확인 필수 (미확인 시 진행 불가)
```

### IF 팩트 검증 결과 모순되는 정보 발견

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 여러 출처의 정보 제시 (신뢰도 함께)
  ✅ 2025년 기준 최신 정보 강조
  ✅ 편집자 주석으로 표시:
       "⚠️ [편집자 주: 2025년 기준 정보가 상이합니다. 원문은 ~, 현재는 ~]"
  ✅ 사용자 최종 판단 필요
```

### IF 편집 품질이 기준 미달 (품질 점수 <75점)

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 문제 부분 플래그 표시
  ✅ 재편집 제안 (자동 재처리)
  ✅ 사용자 선택: 재편집 또는 수동 검토
  ✅ 재편집 결과 비교 제시
```

### IF 편집 중 오류 발생

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 오류 명확히 기록 (오류 코드, 청크ID, 타임스탐프)
  ✅ 영향받은 부분만 재처리
  ✅ 전체 진행 상황 보존 (복구 가능하게)
  ✅ 사용자에게 명확한 복구 옵션 제공
```

### IF 여러 문서 처리 중 일부 문서 오류

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 오류 문서 격리 (나머지는 계속 처리)
  ✅ 완료된 문서는 결과 제공
  ✅ 오류 문서만 재처리 옵션 제시
```

---

## ⚙️ 상태 기반 요구사항 (STATE-DRIVEN)

### WHILE 편집 작업 진행 중

```
시스템은 다음을 유지해야 함:
  ✅ 단계별 처리 상태 (분석중/교정중/교열중/윤문중/검수중/완료)
  ✅ 전체 진행률 (%) 및 남은 작업 시간 예측
  ✅ 각 부분별 품질 점수
  ✅ 변경 사항 임시 저장 (중단 후 재개 가능)
  ✅ 사용자 피드백 대기 항목 추적
```

### WHILE 팩트 검증 진행 중

```
시스템은 다음을 유지해야 함:
  ✅ 검증된 항목 수 vs 총 항목 수
  ✅ 각 항목별 검증 상태 (대기/진행중/완료/주의필요)
  ✅ 신뢰도 평점 (출처별, 항목별)
  ✅ 구식 정보 항목 임시 표시
```

### WHILE 여러 문서 배치 처리 중

```
시스템은 다음을 유지해야 함:
  ✅ 각 문서별 처리 상태 (대기/진행중/완료/오류)
  ✅ 전체 배치 진행률
  ✅ 공통 용어집 누적 상태
  ✅ 예상 완료 시간
```

---

## 🎁 선택 기능 (OPTIONAL)

### WHERE 사용자가 특정 단계만 수행하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 단계별 개별 실행 (교정만, 교열만, 윤문만)
  ✅ 부분 편집 (특정 장/절만)
  ✅ 특정 문제점만 집중 편집 (예: 띄어쓰기만, 외국어 표기법만)
```

### WHERE 사용자가 편집 강도를 커스터마이징하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 교정 강도 선택 (최소/표준/강화)
  ✅ 교열 강도 선택 (일부/전체/심화)
  ✅ 윤문 강도 선택 (가벼움/표준/강화)
  ✅ 강도별 소요 시간 예측
```

### WHERE 사용자가 도메인별 맞춤형 편집을 원할 때

```
시스템은 다음을 제공해야 함:
  ✅ 도메인별 전문 용어 사전 (스타트업, 금융, 법률 등)
  ✅ 도메인별 표기법 규칙 (예: 금융 문서의 숫자 표기)
  ✅ 도메인별 검증 규칙 (예: 법률 용어 정확성)
```

---

## ✅ 기술 상세 사항 (SPECIFICATIONS)

### 편집 3단계의 구현 전략

#### 1. 교정(Proofreading) - Haiku 4.5 활용

**목표**: 한국어 맞춤법, 표기법 완벽 교정

**작업 항목**:
- 한국어 맞춤법 (띄어쓰기, 중복 제거, 오타)
- 외국어 표기법 일관성 (영문 기업명, 전문용어)
- 숫자/단위/기호 규칙 (2025년 기준)
- 공식 문서 규칙 적용 (한글 맞춤법, 표준국어대사전)

**LLM 모델 선택**:
- **Haiku 4.5**: 빠른 처리 ($1/M input, $5/M output)
- 청크당 3-5초 처리

**프롬프트 전략**:
```
당신은 20년 경력의 출판 교정 전문가입니다.
2025년 11월 기준의 최신 한국어 맞춤법 규칙을 정확히 적용합니다.

【교정 항목】
1. 띄어쓰기 (한글-한글, 한글-숫자, 한글-외국어)
2. 맞춤법 (원칙/예외 모두 숙지)
3. 오타 및 중복 제거
4. 외국어 표기법 일관성 (기업명, 기술용어)
5. 숫자 표기 규칙 (아라비아숫자 vs 한글수)
6. 단위/기호 표기법 (m, kg, %, 등)

【출력 형식】
원문:
[원문 텍스트]

수정본:
[수정된 텍스트]

주요 수정 사항:
- [항목1]: [원문] → [수정본] (이유: [설명])
- ...
```

#### 2. 교열(Fact-checking) - Sonnet 4.5 + Context7 MCP

**목표**: 2025년 기준 팩트 검증, 구식 정보 식별

**작업 항목**:
- 통계/수치 검증 (Context7로 2025년 최신 정보)
- 기관명/인물명 검증
- 역사적 사실 검증
- 구식 정보 식별 (편집자 주석 추가)

**LLM 모델 선택**:
- **Sonnet 4.5**: 깊이 있는 검증 ($3/M input, $15/M output)
- 섹션당 10-15초 처리

**팩트 검증 전략**:

```
당신은 2025년 기준의 팩트 체크 전문가입니다.
Context7 MCP를 통해 최신 정보를 검색합니다.

【검증 항목】
1. 통계/수치 (년도, 숫자 정확성)
2. 기관명/인물명 (정확한 표기)
3. 역사적 사실 (년도, 사건)
4. 기술/과학 정보 (2025년 기준)

【구식 정보 처리】
발견 시 다음 형식으로 표시:
[원문: 내용]
✏️ [편집자 주: 2025년 기준: 새로운 정보]

【신뢰도 평점】
- ✅ 확인됨: 정보 정확
- ⚠️ 의심: 출처 확인 필요
- ❌ 오류: 수정 권장

【출력 형식】
검증 결과 요약:
- 총 항목: X개
- 확인됨: X개
- 의심: X개
- 오류: X개
- 구식 정보: X개

상세 내용:
[각 항목별 검증 결과]
```

#### 3. 윤문(Copywriting) - Sonnet 4.5 활용

**목표**: 문체 통일, 명확성 개선, 읽기 쉬운 문장

**작업 항목**:
- 문장 구조 최적화 (단문화, 명확성)
- 문체 통일 (존댓말, 톤앤매너)
- 가독성 개선 (리듬감, 흐름, 문단 구조)
- 저자 의도 완벽 보존

**LLM 모델 선택**:
- **Sonnet 4.5**: 창의적 개선
- 단락당 5-10초 처리

**윤문 프롬프트**:

```
당신은 20년 경력의 출판 윤문 전문가입니다.
원저자의 의도와 톤을 완벽히 보존하면서 가독성을 높입니다.

【윤문 철학】
1. 의미의 충실성 > 구조 변경
   - 저자의 메시지 완벽 전달
   - 뉘앙스와 의도 보존

2. 자연스러운 한국어
   - 번역체 표현 제거
   - 한국 독자의 이해도 최적화

3. 읽기 쉬운 문장
   - 한 문장 한 개념
   - 긴 문장은 2-3개로 분리
   - 불필요한 수식어 제거

【개선 영역】
1. 문장 구조 (복문 → 단문)
2. 어휘 선택 (어려운 용어 → 쉬운 용어, 필요시)
3. 문단 구조 (논리적 흐름)
4. 리듬감 (톤앤매너 일관성)

【검토 기준】
- 원저자의 의도 보존: 100%
- 명확성 개선: +10점 이상
- 읽기 난이도 감소: -2점 이상

【출력 형식】
원문:
[원문 텍스트]

개선본:
[개선된 텍스트]

주요 개선 사항:
- [항목]: 이유 설명
```

### 아키텍처 설계

**4가지 핵심 모듈**:

1. **edit_orchestrator.py**: 전체 워크플로우 조정
   - 문서 로딩, 메타데이터 추출
   - 편집 단계 순서 관리
   - 병렬/순차 처리 조정
   - 결과 통합 및 검수

2. **edit_proofreading.py**: 교정 로직
   - 청크 기반 병렬 처리
   - Haiku 4.5 활용
   - 맞춤법/표기법 자동 교정
   - 변경 사항 기록

3. **edit_fact_checking.py**: 교열 로직
   - Context7 MCP 통합
   - Sonnet 4.5 활용
   - 팩트 검증 및 비교
   - 편집자 주석 생성

4. **edit_copywriting.py**: 윤문 로직
   - 단락 기반 처리
   - Sonnet 4.5 활용
   - 문체/명확성 개선
   - 원문 의도 보존 검증

### 병렬 처리 전략

**교정 단계**:
- 청크 크기: 3,000자
- 최대 워커: 5개
- 처리 시간: 청크당 3-5초

**교열 단계**:
- 섹션 크기: 5,000자
- 최대 워커: 3개 (Context7 API 한계)
- 처리 시간: 섹션당 10-15초

**윤문 단계**:
- 단락 기반 처리
- 최대 워커: 10개
- 처리 시간: 단락당 5-10초

**여러 문서 배치 처리**:
- 순차 처리 (문서별)
- 각 문서는 병렬 처리
- 공통 용어집 재사용 (효율성)

### 품질 평가 지표

**교정 품질**:
- 맞춤법 정확성: ≥99%
- 외국어 표기법 일관성: ≥95%

**교열 품질**:
- 팩트 검증율: 100% (검증 필요 항목)
- 신뢰도 평균: ≥4/5

**윤문 품질**:
- 가독성 개선: +10점 이상
- 의도 보존율: 100%
- 문체 일관성: ≥90%

---

## ✅ 수용 기준 (ACCEPTANCE CRITERIA)

### 시나리오 1: 단일 문서 전체 편집

```
Given: 50,000단어 번역 완료 문서 (LAF)
When: 전체 편집 파이프라인 실행 (교정→교열→윤문)
Then:
  ✅ 완료 시간: 6-8시간 (병렬 처리)
  ✅ 교정 완료: 맞춤법 오류 <1%
  ✅ 교열 완료: 팩트 검증 100%, 구식 정보 식별 완료
  ✅ 윤문 완료: 가독성 +15점, 문체 일관성 ≥95%
  ✅ 최종 품질 점수: ≥90점
  ✅ 출판 완성도: 즉시 출판 가능
```

### 시나리오 2: 여러 문서 배치 처리

```
Given: 4개 문서 (LAF, SAF, SOSHR, CS) 각 50K~100K단어
When: 배치 처리 모드 실행
Then:
  ✅ 공통 용어집 자동 생성 (4개 문서 용어 통일)
  ✅ 문서별 처리 시간: 8-12시간 (순차)
  ✅ 전체 처리 시간: 32-48시간 (순차) 또는 8-12시간 (병렬, 4개 워커)
  ✅ 모든 문서 품질 점수: ≥90점
  ✅ 문서 간 용어 일관성: ≥95%
```

### 시나리오 3: 특정 단계만 수행

```
Given: 이미 교정된 문서
When: 교열 + 윤문만 실행
Then:
  ✅ 교열 진행 (팩트 검증)
  ✅ 윤문 진행 (문체 개선)
  ✅ 소요 시간: 4-6시간
  ✅ 최종 품질: ≥85점
```

### 시나리오 4: 사용자 피드백 반영

```
Given: 편집 완료된 문서 + 사용자 수정 요청 (3개 부분)
When: 부분 재편집 실행
Then:
  ✅ 해당 부분만 재처리 (1-2시간)
  ✅ 전체 문서 일관성 재검수
  ✅ 최종 품질: ≥85점 이상 유지
```

### 시나리오 5: 오류 복구

```
Given: 편집 중 일부 청크 오류 발생
When: 시스템이 오류 감지
Then:
  ✅ 즉시 중단 (이미 완료된 부분 보존)
  ✅ 오류 원인 명확히 기록
  ✅ 사용자에게 재시작 옵션 제시
  ✅ 전체 진행 상황 복구 가능
```

---

## 📊 기술 스택 및 의존성

**필수 Sub-agents**:
- `format-expert`: 교정 담당 (맞춤법, 표기법)
- `fact-checker`: 교열 담당 (팩트 검증, Context7)
- `copywriting-expert`: 윤문 담당 (문체, 명확성)
- `orchestrator`: 청크 관리 및 통합

**필수 Skills**:
- `moai-context7-integration`: 2025년 정보 검색
- `moai-lang-korean`: 한국어 규칙 적용
- `moai-chunk-management`: 텍스트 분할 및 통합

**외부 의존성**:
- **Anthropic Claude API**
  - Claude Haiku 4.5 (교정, 빠른 처리)
  - Claude Sonnet 4.5 (교열, 윤문, 심화 분석)
- **Context7 MCP** (팩트 검증, 2025년 정보)

**개발 환경**:
- Python ≥3.11
- pydantic (데이터 검증)
- concurrent.futures (병렬 처리)
- pathlib (파일 관리)

**버전 요구사항**:
- Claude API: 최신
- Context7 MCP: v1.0+

---

## 📈 성공 지표

- **처리 속도**: 50K단어 문서 6-8시간 (3단계)
- **교정 정확성**: <1% 오류율
- **교열 검증율**: 100% (검증 필요 항목)
- **윤문 품질**: 가독성 +15점 이상 개선
- **최종 품질**: ≥90점 (출판 가능 수준)
- **사용자 만족도**: ≥4.5/5점
- **용어 일관성**: ≥95% (여러 문서)

---

## 🔄 의존성 및 관계

- **SPEC-PUB-TRANSLATE-001**: 번역 파이프라인과 통합
- **SPEC-PUB-EDIT-004**: 기존 편집 로직 재사용
- **SPEC-PUB-ORCHESTRATE-007**: 청크 관리 기반

---

## 📝 다음 단계

1. ✅ 포괄적 편집 도구 SPEC 작성 (이 문서)
2. ⏳ 구현 계획 상세화 (plan.md)
3. ⏳ 수용 기준 상세화 (acceptance.md)
4. ⏳ 각 Sub-agent 개발 시작
5. ⏳ 병렬 처리 최적화 실험
6. ⏳ 4개 문서에 대한 파일럿 실행
