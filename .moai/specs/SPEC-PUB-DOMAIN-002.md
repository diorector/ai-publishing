# SPEC-PUB-DOMAIN-002: 퍼블릭 도메인 발굴 → 번역 → 완성원고

**Version**: 1.0.0
**Status**: DRAFT
**Priority**: HIGH
**Phase**: Phase 1 (핵심 파이프라인)
**Created**: 2025-11-16
**Updated**: 2025-11-16
**Language**: 한국어
**Owner**: @user

---

## 📋 규격 요약

퍼블릭 도메인 저작물을 자동으로 발굴하고, 번역 및 편집하여 출판 가능한 완성원고를 생성합니다. 초기 목표는 월 5권의 퍼블릭 도메인 신간을 자동 출판하는 것입니다.

**처리 소스**:
- 영어 퍼블릭 도메인 (Project Gutenberg, 구글북스 등)
- 한글 퍼블릭 도메인 (국립중앙도서관, 고시조 문헌 등)
- 기타 언어 퍼블릭 도메인 (다국어 지원)

**핵심 처리 단계**:
1. 퍼블릭 도메인 자동 발굴
2. 메타데이터 수집 및 라이선스 검증
3. 원문 추출 및 구조 분석
4. 언어별 처리 (번역 또는 편집)
5. 최종 품질 검수

---

## 🎯 필수 요구사항 (UBIQUITOUS)

> 시스템은 저작권 만료 여부를 자동으로 검증해야 함
> 시스템은 발굴된 모든 도서의 메타데이터를 기록해야 함
> 시스템은 단계별 품질 체크포인트를 유지해야 함
> 시스템은 발굴-번역-편집-검수의 병렬 처리 가능해야 함
> 시스템은 각 도서별 작업 상태를 추적 가능해야 함

---

## 📁 이벤트 기반 요구사항 (EVENT-DRIVEN)

### WHEN 월간 발굴 작업이 시작될 때

```
GIVEN: 발굴 설정 (언어, 분야, 품질 기준)
WHEN: 관리자가 "월간 발굴 시작" 버튼 클릭
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-research] 에이전트 활성화
  ✅ Project Gutenberg, 구글북스, 국내 자료 웹 스크래핑
  ✅ 저작권 만료 여부 자동 검증
  ✅ 50-150권 규모의 후보 목록 생성
  ✅ 평가 점수 산정 (시장성, 품질, 중복도)
  ✅ 상위 5-10권 선정 및 사용자 확인
```

### WHEN 발굴된 도서가 확정될 때

```
GIVEN: 사용자 확정된 퍼블릭 도메인 도서 목록 (5권)
WHEN: 각 도서별 처리 시작
THEN: 시스템은 다음을 수행해야 함
  ✅ 원본 텍스트 추출 (다양한 형식 지원: EPUB, TXT, HTML)
  ✅ 메타데이터 수집 (저자, 발행년도, 원문 언어, ISBN 등)
  ✅ 원본 구조 분석 및 보존
  ✅ 라이선스 정보 기록 (퍼블릭 도메인 명시)
```

### WHEN 원본 처리가 완료될 때

```
GIVEN: 추출된 원본 텍스트 + 메타데이터
WHEN: 원본 언어 분석 완료
THEN: 시스템은 다음을 수행해야 함
  ✅ 원본 언어 자동 감지 (영어/중국어/일본어/기타)
  ✅ 처리 경로 결정:
       - 영어 → SPEC-PUB-TRANSLATE-001 처리
       - 한글 → SPEC-PUB-EDIT-004 처리
       - 기타 언어 → 번역 후 SPEC-PUB-TRANSLATE-001 처리
  ✅ 각 도서의 처리 큐에 추가
  ✅ 병렬 처리 스케줄링 (최대 5권 동시)
```

### WHEN 도서별 번역/편집이 진행될 때

```
GIVEN: 큐에 등록된 도서들
WHEN: [moai-pub-orchestrator]가 병렬 처리 조율
THEN: 시스템은 다음을 수행해야 함
  ✅ 각 도서별 진행 상황 실시간 추적
  ✅ 도서별 예상 완료 시간 계산
  ✅ 병렬 처리 최적화 (리소스 사용)
  ✅ 진행 상황 대시보드 제공
```

### WHEN 완성원고가 생성될 때

```
GIVEN: 편집 완료된 5권의 원고
WHEN: 각 원고별 완성
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-metadata] 스킬로 메타데이터 생성 (ISBN, 커버 정보 등)
  ✅ 최종 품질 검수 (통일성, 일관성)
  ✅ EPUB 변환 준비
  ✅ 출판 준비 상태로 전환
```

---

## 🚫 원하지 않는 동작 (UNWANTED BEHAVIOR)

### IF 저작권 만료 여부 확인 실패

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 해당 도서 즉시 제외
  ✅ 법적 검토 필요 사유 기록
  ✅ 대체 도서 자동 추천
```

### IF 도서 추출 중 인코딩 또는 형식 오류 발생

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 오류 명확히 기록
  ✅ 해당 도서 재처리 시도 (다른 소스에서)
  ✅ 최대 3회 재시도 후 제외
  ✅ 대체 도서 추천
```

### IF 원본 언어 감지 오류

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 수동 언어 확인 요청
  ✅ 사용자 입력 기반 처리 경로 결정
  ✅ 다국어 처리 능력 개선 기록
```

### IF 동시 처리 수 초과

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 나머지 도서를 우선순위 큐에 배치
  ✅ 완료된 도서별로 자동 순차 처리
  ✅ 예상 완료 시간 사용자에게 알림
```

---

## ⚙️ 상태 기반 요구사항 (STATE-DRIVEN)

### WHILE 5권의 병렬 처리 진행 중

```
시스템은 다음을 유지해야 함:
  ✅ 도서별 상태 표시 (발굴중/메타수집중/번역중/편집중/검수중/완료)
  ✅ 전체 진행률 (100건 → 20건 단위)
  ✅ 도서별 예상 완료 시간
  ✅ 리소스 사용률 모니터링
  ✅ 병목 지점 자동 감지
```

---

## 🎁 선택 기능 (OPTIONAL)

### WHERE 사용자가 특정 분야의 도서만 발굴하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 분야별 필터링 (역사, 과학, 문학, 철학 등)
  ✅ 시간대별 필터링 (고전/최근)
  ✅ 저자별 필터링
  ✅ 언어별 필터링
```

### WHERE 사용자가 발굴 기준을 커스터마이징하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 시장성 평가 기준 설정
  ✅ 품질 기준 설정
  ✅ 우선순위 자동 계산 규칙
```

---

## ✅ 수용 기준 (ACCEPTANCE CRITERIA)

### Given/When/Then 시나리오 1: 월간 발굴 흐름

```
Given: 월간 발굴 설정 (영어 + 한글 + 중국어)
When: 월간 자동 발굴 실행
Then:
  ✅ 3시간 내 50-150권 후보 발굴
  ✅ 저작권 검증: 100% 정확
  ✅ 상위 5권 추천 (시장성 점수 ≥75점)
  ✅ 메타데이터 수집율 ≥95%
  ✅ 발굴 결과 리포트 생성
```

### Given/When/Then 시나리오 2: 병렬 처리 완료

```
Given: 확정된 5권의 퍼블릭 도메인
When: 동시 처리 실행
Then:
  ✅ 모든 도서 2-3주 내 완성원고 생성
  ✅ 병렬도: 최대 5권 동시 처리 (리소스 효율)
  ✅ 중간 진행 상황 실시간 추적
  ✅ 각 도서별 완성원고 품질 ≥85점
```

### Given/When/Then 시나리오 3: 메타데이터 자동생성

```
Given: 완성원고 5권
When: 메타데이터 자동생성 요청
Then:
  ✅ ISBN, 커버 정보, 책소개 자동 생성
  ✅ 퍼블릭 도메인 명시 자동 포함
  ✅ EPUB 메타데이터 자동 삽입
  ✅ 출판 준비 완료 상태로 전환
```

---

## 📊 기술 스택 및 의존성

**필수 에이전트**:
- `moai-pub-research`: 퍼블릭 도메인 발굴 및 라이선스 검증
- `moai-pub-translator`: 번역 (외국어 도서)
- `moai-pub-editor`: 편집
- `moai-pub-orchestrator`: 병렬 처리 조율

**필수 스킬**:
- `moai-pub-chunking`: 텍스트 분할
- `moai-pub-metadata`: 메타데이터 생성

**외부 자료**:
- Project Gutenberg API
- 구글북스 API
- 국립중앙도서관 데이터
- 저작권 데이터베이스

**버전 요구사항**:
- Python ≥3.11
- Claude Sonnet 4.5+ (복잡한 작업)
- Claude Haiku 4.5 (병렬 처리)

---

## 📈 성공 지표

- **발굴 속도**: 월 50-150권 후보 발굴
- **정확성**: 저작권 검증 100%, 메타데이터 수집 ≥95%
- **처리 속도**: 5권 동시 처리 2-3주 완료
- **품질**: 각 원고 ≥85점
- **자동화율**: 메타데이터 자동생성 100%

---

## 🔄 의존성

- SPEC-PUB-TRANSLATE-001: 번역 처리 재사용
- SPEC-PUB-EDIT-004: 한글 편집 처리 재사용
- SPEC-007: 병렬 처리 조율 필요
