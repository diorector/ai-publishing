# SPEC-PUB-EDIT-004: 한글 원고 편집 (교정교열 + 윤문)

**Version**: 1.0.0
**Status**: DRAFT
**Priority**: HIGH
**Phase**: Phase 1 (핵심 파이프라인)
**Created**: 2025-11-16
**Updated**: 2025-11-16
**Language**: 한국어
**Owner**: @user

---

## 📋 규격 요약

작가가 제공한 한글 원고(초안, 미완성, 기타)를 자동으로 편집하여 당장 출판이 가능한 완성원고로 변환합니다. 교정교열(문법, 띄어쓰기, 오타)과 윤문(문체, 흐름, 명확성)을 포함합니다.

**편집 단계**:
1. 원고 분석 (구조, 논리, 문제점 파악)
2. 구조 편집 (필요시 재배열)
3. 교정교열 (문법, 오류 수정)
4. 윤문 (문체 통일, 가독성 개선)
5. 스타일 가이드 적용
6. 최종 검수

---

## 🎯 필수 요구사항 (UBIQUITOUS)

> 시스템은 작가의 의도를 최대한 보존해야 함
> 시스템은 편집 전/후 버전을 모두 유지해야 함
> 시스템은 교정 사항을 감사 추적 가능하게 기록해야 함
> 시스템은 당장 출판이 가능한 완성원고를 생성해야 함
> 시스템은 다양한 원고 형식(초안/미완성/기타)을 수용해야 함

---

## 📁 이벤트 기반 요구사항 (EVENT-DRIVEN)

### WHEN 작가가 원고를 업로드할 때

```
GIVEN: 한글 원고 파일 (마크다운, 워드, TXT 등)
WHEN: 작가가 원고 파일과 기본 정보 업로드
THEN: 시스템은 다음을 수행해야 함
  ✅ 파일 형식 자동 감지 및 마크다운으로 변환
  ✅ 원고 메타데이터 수집 (제목, 저자, 대상 독자 등)
  ✅ 원고 길이 및 구조 분석
  ✅ 기본 통계 제시 (단어 수, 문단 수, 예상 편집 시간)
  ✅ 사용자 확인 후 편집 진행
```

### WHEN 원고 분석이 완료될 때

```
GIVEN: 업로드된 한글 원고
WHEN: 자동 분석 완료
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-editor] 에이전트로 원고 진단:
       - 구조 및 논리 평가
       - 주요 문제점 식별 (문법, 일관성, 명확성)
       - 개선 제안 제시
  ✅ 사용자에게 분석 결과 및 예상 편집 방향 제시
  ✅ 사용자 승인 또는 커스터마이징 기회 제공
```

### WHEN 편집 설정이 완료될 때

```
GIVEN: 편집 방향 확정
WHEN: 사용자가 "편집 시작" 버튼 클릭
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-chunking] 스킬로 원고 청크 분할
  ✅ [moai-pub-editor] 에이전트 병렬 호출 (최대 5개 청크)
  ✅ 각 청크별 다음 작업 수행:
       - 교정교열 (문법, 오타, 띄어쓰기)
       - 윤문 (문체, 흐름, 명확성)
       - [moai-pub-style-guide] 규칙 적용
  ✅ 편집 진행 상황 실시간 추적
```

### WHEN 각 청크 편집이 완료될 때

```
GIVEN: 편집된 청크
WHEN: 각 청크 완성
THEN: 시스템은 다음을 수행해야 함
  ✅ 원문과 편집본 비교 생성
  ✅ 주요 변경 사항 명확히 기록
  ✅ 사용자 검토 기회 제공 (수락/거부/수정)
  ✅ 피드백 수집 및 반영
```

### WHEN 모든 청크 편집이 완료될 때

```
GIVEN: 편집 완료된 모든 청크
WHEN: 마지막 청크 처리 완료
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-orchestrator]로 청크 통합 (원본 순서 복원)
  ✅ 전체 원고 일관성 재검수:
       - 용어 통일
       - 톤앤매너 일관성
       - 논리적 연속성
  ✅ 전체 원고 교정교열 재검증
  ✅ 최종 마크다운 생성
```

---

## 🚫 원하지 않는 동작 (UNWANTED BEHAVIOR)

### IF 원고의 구조가 심각하게 손상됨

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 경고 알림 제시
  ✅ 구조 재구성 필요 여부 사용자 확인
  ✅ 수동 개입 옵션 제공
```

### IF 편집 과정에서 원문의 의도 훼손 가능성 감지

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 해당 부분 플래그 표시
  ✅ 원문과 편집본 명확히 제시
  ✅ 사용자 최종 확인 필수
  ✅ 미확인 상태로는 진행 불가
```

### IF 편집 품질이 기준 미달

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 품질 점수 <75점인 청크 플래그
  ✅ 재편집 제안
  ✅ 사용자 선택: 재편집 또는 수동 검토
```

### IF 편집 중 오류 발생

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 오류 명확히 기록
  ✅ 영향받은 청크만 재처리
  ✅ 전체 작업 진행 상황 보존
  ✅ 사용자에게 명확한 복구 옵션 제공
```

---

## ⚙️ 상태 기반 요구사항 (STATE-DRIVEN)

### WHILE 병렬 편집 진행 중

```
시스템은 다음을 유지해야 함:
  ✅ 청크별 편집 상태 (분석중/교정중/윤문중/검수중/완료)
  ✅ 전체 진행률
  ✅ 각 청크별 품질 점수
  ✅ 원문과 편집본 비교 정보
  ✅ 사용자 피드백 대기 항목 추적
```

---

## 🎁 선택 기능 (OPTIONAL)

### WHERE 사용자가 특정 부분만 편집하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 특정 장/절 범위 선택 편집
  ✅ 특정 문제점만 집중 편집 (예: 띄어쓰기만)
  ✅ 부분 편집 후 통합 기능
```

### WHERE 사용자가 편집 강도를 커스터마이징하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 강도 선택 (최소/표준/강화)
  ✅ 강도별 편집 항목 명시
  ✅ 결과 품질 예측
```

---

## ✅ 수용 기준 (ACCEPTANCE CRITERIA)

### Given/When/Then 시나리오 1: 기본 편집 흐름

```
Given: 100,000단어 원고 (초안, 문법 오류 포함)
When: 표준 강도 편집 실행
Then:
  ✅ 편집 완료: 3-5주
  ✅ 교정 오류: <1%
  ✅ 윤문 개선: 가독성 +15점 이상
  ✅ 용어 통일도: ≥95%
  ✅ 최종 원고 당장 출판 가능
```

### Given/When/Then 시나리오 2: 병렬 편집

```
Given: 100,000단어 원고를 5개 청크로 분할
When: 병렬 편집 실행
Then:
  ✅ 전체 편집 시간: 순차 대비 60% 단축
  ✅ 청크 간 일관성: ≥90점
  ✅ 통합 검수 시간: 2-3일
  ✅ 최종 원고 품질: ≥85점
```

### Given/When/Then 시나리오 3: 부분 편집

```
Given: 완성원고 중 특정 3개 장만 재편집 필요
When: 부분 재편집 실행
Then:
  ✅ 해당 부분만 재처리 (2-3일)
  ✅ 전체 통합 검수 (1일)
  ✅ 전체 원고 일관성 유지: ≥95점
```

---

## 📊 기술 스택 및 의존성

**필수 에이전트**:
- `moai-pub-editor`: 교정교열 + 윤문 담당
- `moai-pub-orchestrator`: 청크 관리 및 통합

**필수 스킬**:
- `moai-pub-chunking`: 텍스트 분할
- `moai-pub-style-guide`: 스타일 규칙 적용

**버전 요구사항**:
- Python ≥3.11
- Claude Sonnet 4.5+ (복잡한 편집)
- Claude Haiku 4.5 (병렬 처리)

---

## 📈 성공 지표

- **편집 속도**: 100K 단어 3-5주
- **정확성**: 교정 오류 <1%
- **품질 개선**: 가독성 +15점 이상
- **일관성**: 용어 통일 ≥95%
- **사용자 만족도**: ≥4/5별

---

## 🔄 의존성

- SPEC-PUB-TRANSLATE-001: 편집 로직 재사용
- SPEC-007: 병렬 처리 및 통합 기반 필요
