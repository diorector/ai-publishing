# SPEC-PUB-DRAFT-006: 원고 초안 편집 (심화 편집 파이프라인)

**Version**: 1.0.0
**Status**: DRAFT
**Priority**: MEDIUM
**Phase**: Phase 1 (핵심 파이프라인)
**Created**: 2025-11-16
**Updated**: 2025-11-16
**Language**: 한국어
**Owner**: @user

---

## 📋 규격 요약

작가가 제공한 원고 초안을 출판 가능한 완성원고로 변환합니다. SPEC-004(한글 원고 편집)와 달리, 더 깊이 있는 구조적 편집과 내용 보강을 포함합니다. 초안 단계의 원고를 높은 수준의 완성도로 끌어올리는 전문 편집 서비스입니다.

**편집 단계**:
1. 초안 분석 (구조, 논리, 콘텐츠 평가)
2. 구조 재구성 (필요시 대규모 개편)
3. 내용 보강 (부족한 부분 추가)
4. 교정교열 + 윤문
5. 스타일 가이드 적용
6. 최종 검수

---

## 🎯 필수 요구사항 (UBIQUITOUS)

> 시스템은 작가의 기본 의도를 보존하면서 전문성을 높여야 함
> 시스템은 내용의 정확성 검증을 포함해야 함
> 시스템은 구조적 문제를 근본적으로 해결해야 함
> 시스템은 편집 과정의 모든 단계를 추적 가능하게 기록해야 함
> 시스템은 당장 출판이 가능한 완성원고를 생성해야 함

---

## 📁 이벤트 기반 요구사항 (EVENT-DRIVEN)

### WHEN 작가가 초안을 업로드할 때

```
GIVEN: 원고 초안 (초기 단계, 미완성)
WHEN: 파일 업로드 + 기본 정보 제공 (제목, 저자, 분야, 대상 독자)
THEN: 시스템은 다음을 수행해야 함
  ✅ 파일 형식 자동 감지 및 마크다운으로 변환
  ✅ 초안 상태 분석 (완성도, 주요 문제점)
  ✅ 상세한 진단 리포트 생성
  ✅ 예상 편집 수준 및 소요 시간 제시
```

### WHEN 초안 분석이 완료될 때

```
GIVEN: 업로드된 초안
WHEN: 심층 분석 완료
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-writer] 에이전트로 상세 진단:
       - 구조 분석 (논리적 흐름, 챕터 구성)
       - 콘텐츠 평가 (정보량, 정확성, 설득력)
       - 부족한 부분 식별 (채워야 할 내용)
       - 재구성 제안 (대규모 개편 필요 여부)
  ✅ 상세한 편집 계획 및 예상 결과 제시
  ✅ 작가 확인 및 편집 방향 결정
```

### WHEN 편집 방향이 확정될 때

```
GIVEN: 최종 편집 계획 확정
WHEN: 사용자가 "심화 편집 시작" 클릭
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-chunking] 스킬로 원고 분할
  ✅ 각 청크별 처리 순서 결정:
       - 구조 재구성 필요 부분 우선 처리
       - 내용 보강 필요 부분 식별
       - 병렬 처리 스케줄 수립
  ✅ 병렬 편집 시작 (최대 5개 청크)
```

### WHEN 구조 재구성이 진행될 때

```
GIVEN: 구조 개편이 필요한 초안
WHEN: 각 섹션별 재구성 실행
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-writer] 에이전트로 재구성:
       - 논리적 흐름 개선
       - 필요시 내용 추가 또는 삭제
       - 새로운 구조에 맞춰 재작성
  ✅ 재구성 전/후 비교 제시
  ✅ 작가 검토 및 승인
```

### WHEN 내용 보강이 진행될 때

```
GIVEN: 부족한 콘텐츠가 식별된 부분
WHEN: 내용 보강 작업 실행
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-fact-checker] 스킬로 필요 정보 검색:
       - Context7 MCP를 통한 신뢰 출처 검색
       - 관련 자료 수집
  ✅ [moai-pub-writer]로 내용 추가:
       - 원 주제와 자연스럽게 통합
       - 논리적 연결 유지
  ✅ 추가된 내용 사용자 검토
```

### WHEN 교정교열 및 윤문이 진행될 때

```
GIVEN: 구조 재구성 + 내용 보강 완료
WHEN: 교정교열 단계 실행
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-editor] 에이전트로:
       - 교정교열 (문법, 오타, 띄어쓰기)
       - 윤문 (문체, 흐름, 가독성)
  ✅ [moai-pub-style-guide] 규칙 적용
  ✅ 편집 전/후 비교 제시
```

### WHEN 모든 청크 처리가 완료될 때

```
GIVEN: 처리 완료된 모든 청크
WHEN: 최종 통합 단계
THEN: 시스템은 다음을 수행해야 함
  ✅ [moai-pub-orchestrator]로 통합:
       - 청크 재결합 (원본 순서 복원)
       - 구조적 일관성 확인
  ✅ 전체 원고 최종 검수:
       - 용어 통일
       - 톤앤매너 일관성
       - 논리적 연속성
       - 정보 정확성 재검증
  ✅ 완성원고 마크다운 생성
```

---

## 🚫 원하지 않는 동작 (UNWANTED BEHAVIOR)

### IF 구조 재구성이 너무 과도함

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 재구성 정도 명확히 표시
  ✅ 원문과 재구성본 명확히 비교
  ✅ 작가 최종 승인 필수
```

### IF 추가된 내용이 원문의 톤과 맞지 않음

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 톤 불일치 부분 식별
  ✅ 조정 제안 제시
  ✅ 작가 검토 및 승인 필수
```

### IF 원래 작가의 고유한 목소리 손실

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 목소리 보존도 평가
  ✅ 필요한 부분 복원 제안
  ✅ 작가 최종 확인
```

### IF 편집 과정에서 오류 발생

```
THEN: 시스템은 다음을 수행해야 함
  ✅ 오류 명확히 기록
  ✅ 영향받은 부분 재처리
  ✅ 전체 진행 상황 보존
```

---

## ⚙️ 상태 기반 요구사항 (STATE-DRIVEN)

### WHILE 심화 편집 진행 중

```
시스템은 다음을 유지해야 함:
  ✅ 청크별 진행 상태 (분석중/재구성중/보강중/교정중/검수중/완료)
  ✅ 전체 진행률
  ✅ 각 단계별 품질 점수
  ✅ 작가 승인 대기 항목
  ✅ 구조 변경 정도 추적
```

---

## 🎁 선택 기능 (OPTIONAL)

### WHERE 작가가 특정 부분만 집중 편집하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 부분 선택 편집 기능
  ✅ 선택 부분만 심화 편집 처리
  ✅ 나머지 부분은 기본 편집 (SPEC-004)
```

### WHERE 작가가 편집 정도를 조정하고 싶을 때

```
시스템은 다음을 제공해야 함:
  ✅ 편집 강도 선택 (표준/강화/최대)
  ✅ 강도별 처리 항목 명시
  ✅ 예상 결과 미리 보기
```

---

## ✅ 수용 기준 (ACCEPTANCE CRITERIA)

### Given/When/Then 시나리오 1: 기본 심화 편집

```
Given: 50,000단어 초안 (구조 문제, 내용 부족, 문법 오류 포함)
When: 전체 심화 편집 실행
Then:
  ✅ 편집 소요 시간: 4-6주
  ✅ 구조 개선: 원본과 큰 차이 있어도 자연스러운 전환
  ✅ 내용 보강: 부족한 부분 ≥80% 추가
  ✅ 최종 원고: 당장 출판 가능
  ✅ 품질: 가독성 ≥85점, 완성도 ≥90점
  ✅ 작가 목소리 보존: ≥80%
```

### Given/When/Then 시나리오 2: 병렬 처리 효율성

```
Given: 50,000단어를 5개 청크로 분할
When: 병렬 심화 편집 실행
Then:
  ✅ 전체 편집 시간: 순차 대비 50% 단축
  ✅ 청크 간 일관성: ≥90점
  ✅ 통합 검수 시간: 3-5일
```

### Given/When/Then 시나리오 3: 구조 재구성 효과

```
Given: 논리 구조가 미흡한 초안
When: 구조 재구성 + 내용 보강 실행
Then:
  ✅ 논리적 연속성: +30점 이상 향상
  ✅ 정보 완성도: +25% 이상 증가
  ✅ 가독성: +20점 이상 향상
  ✅ 작가 의도 보존: ≥95%
```

---

## 📊 기술 스택 및 의존성

**필수 에이전트**:
- `moai-pub-writer`: 재구성 + 내용 보강
- `moai-pub-editor`: 교정교열 + 윤문
- `moai-pub-orchestrator`: 병렬 처리 조율

**필수 스킬**:
- `moai-pub-chunking`: 텍스트 분할
- `moai-pub-fact-checker`: 팩트체크 + 내용 검증
- `moai-pub-style-guide`: 스타일 규칙

**외부 자료**:
- Context7 MCP (내용 보강 자료 검색)

**버전 요구사항**:
- Python ≥3.11
- Claude Sonnet 4.5+ (복잡한 재구성)
- Claude Haiku 4.5 (병렬 처리)

---

## 📈 성공 지표

- **편집 속도**: 50K 단어 4-6주
- **구조 개선**: +30점 이상
- **내용 보강**: ≥80% 추가
- **품질**: 가독성 ≥85점, 완성도 ≥90점
- **작가 목소리 보존**: ≥80%
- **사용자 만족도**: ≥4.5/5별

---

## 🔄 의존성

- SPEC-PUB-EDIT-004: 기본 편집 로직 활용
- SPEC-PUB-WRITE-003: 내용 보강 로직 재사용
- SPEC-007: 병렬 처리 기반 필요
